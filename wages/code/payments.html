<!DOCTYPE html>
<html>
<head>
    <title>Add Payment</title>
</head>
<body>
    <h2>Add Payment</h2>

    <form method="POST">
        <label>Date:</label>
        <input type="date" name="date" id="date" required><br><br>

        <label>Hours Worked:</label>
        <input type="number" name="hours" id="hours" step="0.1" readonly><br><br>

        <label>Hourly Wage (₹):</label>
        <input type="number" name="wage" id="wage" step="0.01" readonly><br><br>

        <label>Amount to Pay (₹):</label>
        <input type="number" name="amount" id="amount" step="0.01" readonly><br><br>

        <label>Mode of Payment:</label>
        <input type="text" name="mode" required><br><br>

        <button type="submit">Submit</button>
    </form>

    <script>
        // Automatically set today's date
        document.getElementById('date').valueAsDate = new Date();

        const hoursInput = document.getElementById('hours');
        const wageInput = document.getElementById('wage');
        const amountInput = document.getElementById('amount');

        // Extract worker_id from URL (like /payment/3)
        const workerId = window.location.pathname.split('/').pop();

        // Fetch wage and total hours for this worker
        fetch(`/get_worker_info/${workerId}`)
            .then(response => response.json())
            .then(data => {
                wageInput.value = data.hourly_wage.toFixed(2);
                hoursInput.value = data.hours_worked.toFixed(2);
                amountInput.value = (data.hourly_wage * data.hours_worked).toFixed(2);
            });
    </script>
</body>
</html>
